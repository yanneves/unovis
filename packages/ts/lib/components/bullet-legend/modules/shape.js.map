{"version":3,"file":"shape.js","sources":["../../../../src/components/bullet-legend/modules/shape.ts"],"sourcesContent":["import { Selection } from 'd3-selection'\n\n// Types\nimport { ColorAccessor } from 'types/accessor'\n\n// Utils\nimport { getColor } from 'utils/color'\nimport { circlePath } from 'utils/path'\n\n// Constants\nimport { PATTERN_SIZE_PX } from 'styles/patterns'\n\n// Local types\nimport { BulletLegendConfigInterface } from '../config'\nimport { BulletShape, BulletLegendItemInterface } from '../types'\n\n// Size with respect to the viewBox. We use this to compute path data which is independent of the\n// the configured size.\nconst BULLET_SIZE = PATTERN_SIZE_PX * 3\n\nfunction getHeight (shape: BulletShape): number {\n  switch (shape) {\n    case BulletShape.Line:\n      return BULLET_SIZE / 2.5\n    default:\n      return BULLET_SIZE\n  }\n}\n\nfunction getPath (shape: BulletShape, width: number, height: number): string {\n  switch (shape) {\n    case BulletShape.Line:\n      return `M0,${height / 2} L${width / 2},${height / 2} L${width},${height / 2}`\n    case BulletShape.Square:\n      return `M0,0 L${width},0 L${width},${height} L0,${height}Z`\n    case BulletShape.Circle:\n      return circlePath(height / 2, height / 2, height / 2 - 1)\n  }\n}\n\nexport function createBullets (\n  container: Selection<HTMLSpanElement, BulletLegendItemInterface, HTMLDivElement, unknown>,\n  config: BulletLegendConfigInterface\n): void {\n  container.append('svg')\n    .attr('width', '100%')\n    .attr('height', '100%')\n    .append('path')\n    .attr('d', getPath(config.bulletShape, BULLET_SIZE, getHeight(config.bulletShape)))\n}\n\nexport function updateBullets (\n  container: Selection<HTMLSpanElement, BulletLegendItemInterface, HTMLDivElement, unknown>,\n  config: BulletLegendConfigInterface,\n  colorAccessor: ColorAccessor<BulletLegendItemInterface>\n): void {\n  const width = BULLET_SIZE\n  const height = getHeight(config.bulletShape)\n\n  const getOpacity = (d: BulletLegendItemInterface): number => d.inactive ? 0.4 : 1\n\n  const selection = container.select('svg')\n    .attr('viewBox', `0 0 ${width} ${height}`)\n    .select('path')\n    .attr('d', getPath(config.bulletShape, width, height))\n    .attr('stroke', (d, i) => getColor(d, colorAccessor, i))\n    .style('stroke-width', '1px')\n    .style('fill', (d, i) => getColor(d, colorAccessor, i))\n    .style('fill-opacity', getOpacity)\n\n  if (config.bulletShape === BulletShape.Line) {\n    selection\n      .style('stroke-width', `${height / 5}px`)\n      .style('opacity', getOpacity)\n      .style('fill', null)\n      .style('fill-opacity', null)\n      .style('marker-start', 'none')\n      .style('marker-end', 'none')\n  }\n}\n"],"names":[],"mappings":"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"}